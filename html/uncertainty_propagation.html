
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Uncertainty propagation &#8212; SANDY  documentation</title>
    <link rel="stylesheet" href="_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script async="async" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Exercises" href="exercises.html" />
    <link rel="prev" title="Theory" href="theory.html" />
   
  <link rel="stylesheet" href="_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <div class="section" id="uncertainty-propagation">
<h1>Uncertainty propagation<a class="headerlink" href="#uncertainty-propagation" title="Permalink to this headline">¶</a></h1>
<p>Below is reported the mathematical basis to perform a nuclear data uncertainty
propagation using sets of perturbed files generated with SANDY.</p>
<div class="section" id="monte-carlo-uncertainty-propagation">
<h2>Monte Carlo uncertainty propagation<a class="headerlink" href="#monte-carlo-uncertainty-propagation" title="Permalink to this headline">¶</a></h2>
<p>It is common to refer with the term <em>Monte Carlo uncertainty propagation</em> to
computational approaches that rely on repeated calculation of a quantity
<span class="math">y</span>, each time varying the input data randomly according to a given
multivariate PDF.</p>
<p>It is common to refer with the term <em>Monte Carlo</em> to computational approaches
that rely on a repeated random sampling of chosen parameters to obtain
statistical outcomes of selected responses.</p>
<p>Now, lets us take <span class="math">x=\left[x_1, x_2, \dots, x_m\right]^T</span> as the input
parameters for a model <span class="math">y = f(x)</span>.
If <span class="math">p(x, \Sigma)</span> is the joint PDF of the input data and <span class="math">\Sigma</span>
is the covariance matrix, then <span class="math">X</span> is the sample matrix containing on
its columns <span class="math">n</span> independent sets of samples of the type
<span class="math">x^{(k)}=\left[x_1^{(k)}, x_2^{(k)}, \dots, x_m^{(k)}\right]^T</span> with
<span class="math">k \in 1,\dots,n</span>.</p>
<div class="math">
<p><span class="math">X=\begin{bmatrix}
 x_1^{(1)} &amp; x_1^{(2)} &amp; ... &amp; x_1^{(n)} \\
 x_2^{(1)} &amp; x_2^{(2)} &amp; ... &amp; x_2^{(n)} \\
 \vdots    &amp; \vdots    &amp; \ddots &amp; \vdots \\
 x_m^{(1)} &amp; x_m^{(2)} &amp; ... &amp; x_m^{(n)} \\
\end{bmatrix}\,.</span></p>
</div><p>The samples are taken <em>with replacement</em>, that is, each point in the model input
domain is not excluded after being sampled.</p>
<p>One can prove that for any given parameter <span class="math">i</span>, when
<span class="math">n\rightarrow\infty</span>, then</p>
<div class="math" id="equation-x-mean-variance">
<p><span class="eqno">(1)<a class="headerlink" href="#equation-x-mean-variance" title="Permalink to this equation">¶</a></span><span class="math">\overline{x}_i \equiv &amp; \frac{1}{n}\sum_{k=1}^n x_i^{(k)} \rightarrow E\left[x_i\right]\,, \\
s^2_{x_i} \equiv &amp; \frac{1}{n}\sum_{k=1}^n \left( x_i^{(k)} - E\left[x_i\right]\right)^2 \rightarrow V(x_i)\,.</span></p>
</div><p>Analogously, as <span class="math">n\rightarrow\infty</span>, the samples’ distribution and
covariance matrix converge to <span class="math">p(x, \Sigma)</span>.</p>
<p>If the user wants to quantify the uncertainty of <span class="math">y</span> produced by
<span class="math">x</span> — assuming that the model <span class="math">f</span> does not carry any error —
then, one could symply use</p>
<div class="math" id="equation-y-sample-mean-variance">
<p><span class="eqno">(2)<a class="headerlink" href="#equation-y-sample-mean-variance" title="Permalink to this equation">¶</a></span><span class="math">E\left[f(x)\right] &amp;= \int f(x) p(x,\Sigma) dx\,, \\
E\left[ (f(x) - E\left[f(x)\right])^2 \right] &amp;= \int f(x)^2 p(x,\Sigma) dx - E\left[f(x)\right] \,.</span></p>
</div><p>The Monte Carlo sampling approach for uncertainty quantification uses
a straightforward technique to reproduce the integrals reported above.
For any given set <span class="math">k</span> of sampled input parameters <span class="math">x^{(k)}</span>
a model <em>perturbed</em> response is quantified as <span class="math">y^{(k)} = f(x^{(k)})</span>.</p>
<p>Then, the mean and variance of the population of <span class="math">n</span> perturbed responses
can be calculated as</p>
<div class="math" id="equation-y-mean-variance">
<p><span class="eqno">(3)<a class="headerlink" href="#equation-y-mean-variance" title="Permalink to this equation">¶</a></span><span class="math">\overline{y} \equiv &amp; \frac{1}{n}\sum_{k=1}^n y^{(k)}\,, \\
s^2_{y} \equiv &amp; \frac{1}{n}\sum_{k=1}^n \left( y^{(k)} - \overline{y}\right)^2\,,</span></p>
</div><p>which converge to the real solutions for <span class="math">n\rightarrow\infty</span>.</p>
<p>This procedure can be further extended to multi-response models.</p>
</div>
<div class="section" id="conclusions">
<h2>Conclusions<a class="headerlink" href="#conclusions" title="Permalink to this headline">¶</a></h2>
<p>In short, the Monte Carlo sampling for uncertainty propagation simply
consists in running the same model multiple times, every time replacing the input
parameters with a new set of samples.
This approach brings numerous advantages compared to other uncertainty propagation
techniques, such as perturbation theory:</p>
<blockquote>
<div><ul class="simple">
<li>its application to any model is straightforward, as it does not interact with the
model itself but only with the model inputs;</li>
<li>there is no need for developing complicated algorithms to calculate adjoint
functions for the model and responses under study;</li>
<li>it does not apply only locally around the input best estimates, but it can cover
the whole input and output phase space;</li>
<li>it can represent any-order effect of the model, as well as interactions between
model inputs.</li>
</ul>
</div></blockquote>
<p>The major drawback of this method lies in the large amount of sets of samples
that must be drawn in order to grant the convergence of the response statistics,
that is, to reduce the statistical error <span class="math">\epsilon</span> on the response best estimate.
The central limit theorem tells us that this error is proportional to
<span class="math">1/\sqrt{n}</span> and <span class="math">lim_{n\rightarrow\infty} \epsilon = 0</span></p>
<p>The huge improvements of computer performances in the last decades, combined with
model simplifications and dimensionality reductions help reduce the computational
time of the solvers, thus making Monte Carlo sampling a practical option for
nuclear data uncertainty propagation.</p>
</div>
</div>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="index.html">SANDY</a></h1>








<h3>Navigation</h3>
<p class="caption"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="introduction.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="installation.html">Getting started</a></li>
<li class="toctree-l1"><a class="reference internal" href="endf6.html">The ENDF-6 format</a></li>
<li class="toctree-l1"><a class="reference internal" href="theory.html">Theory</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Uncertainty propagation</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#monte-carlo-uncertainty-propagation">Monte Carlo uncertainty propagation</a></li>
<li class="toctree-l2"><a class="reference internal" href="#conclusions">Conclusions</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="exercises.html">Exercises</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="index.html">Documentation overview</a><ul>
      <li>Previous: <a href="theory.html" title="previous chapter">Theory</a></li>
      <li>Next: <a href="exercises.html" title="next chapter">Exercises</a></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2018, Luca Fiorito.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 1.8.1</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.12</a>
      
      |
      <a href="_sources/uncertainty_propagation.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>