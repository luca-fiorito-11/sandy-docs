

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Theory &mdash; SANDY  documentation</title>
  

  
  
  
  

  

  
  
    

  

  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Uncertainty propagation" href="uncertainty_propagation.html" />
    <link rel="prev" title="The ENDF-6 format" href="endf6.html" /> 

  
  <script src="_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="index.html" class="icon icon-home"> SANDY
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="introduction.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="installation.html">Getting started</a></li>
<li class="toctree-l1"><a class="reference internal" href="endf6.html">The ENDF-6 format</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Theory</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#sampling-methodology">Sampling methodology</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#negative-eigenvalues">Negative eigenvalues</a></li>
<li class="toctree-l3"><a class="reference internal" href="#how-to-apply-multigroup-perturbations-to-continuous-energy-data">How to apply multigroup perturbations to continuous-energy data</a></li>
<li class="toctree-l3"><a class="reference internal" href="#how-to-handle-negative-samples">How to handle negative samples</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#how-to-perturb-cross-sections">How to perturb cross sections</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#covariances-for-resonance-parameters">Covariances for resonance parameters</a></li>
<li class="toctree-l3"><a class="reference internal" href="#redundant-cross-sections">Redundant cross sections</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#how-to-perturb-fission-neutron-multiplicities">How to perturb fission neutron multiplicities</a></li>
<li class="toctree-l2"><a class="reference internal" href="#how-to-perturb-angular-distributions">How to perturb angular distributions</a></li>
<li class="toctree-l2"><a class="reference internal" href="#how-to-perturb-energy-distributions">How to perturb energy distributions</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#normalization">Normalization</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="uncertainty_propagation.html">Uncertainty propagation</a></li>
<li class="toctree-l1"><a class="reference internal" href="exercises.html">Exercises</a></li>
<li class="toctree-l1"><a class="reference internal" href="api.html">Ptyhon API for nuclear data files</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">SANDY</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
      <li>Theory</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/theory.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="theory">
<h1>Theory<a class="headerlink" href="#theory" title="Permalink to this headline">¶</a></h1>
<div class="section" id="sampling-methodology">
<h2>Sampling methodology<a class="headerlink" href="#sampling-methodology" title="Permalink to this headline">¶</a></h2>
<p>To describe the sampling methodology implemented in SANDY we introduce some
assumptions with the purpose of simplifying the explanation.
Let us assume that a given ENDF-6 file contains only one covariance matrix
<span class="math notranslate nohighlight">\(\Sigma\)</span> that:</p>
<blockquote>
<div><ul class="simple">
<li>is defined over <span class="math notranslate nohighlight">\(M\)</span> energy groups;</li>
<li>is in relative units;</li>
<li>is representative for a continuous energy data type, say, cross section.</li>
</ul>
</div></blockquote>
<p>No loss of generality follows by imposing this assumptions as it happens that
they apply to almost all the covariances allowed by the ENDF-6 format.</p>
<p>SANDY parses the ENDF-6 file, it extracts the covariance matrix and constructs
a multivariate Normal distribution <span class="math notranslate nohighlight">\(N(0,\Sigma)\)</span>.
To sample from a multivariate Normal distribution, first we must
draw a matrix <span class="math notranslate nohighlight">\(X\)</span> of <span class="math notranslate nohighlight">\(m\)</span> independent and identically <span class="math notranslate nohighlight">\(N(0,1)\)</span>
distributed variables <span class="math notranslate nohighlight">\(x=[x_1, x_2, \dots, x_m]\)</span>.</p>
<div class="math notranslate nohighlight" id="equation-x-samples">
<span class="eqno">(1)<a class="headerlink" href="#equation-x-samples" title="Permalink to this equation">¶</a></span>\[\begin{split}X=\begin{bmatrix}
 x_1^{(1)} &amp; x_1^{(2)} &amp; ... &amp; x_1^{(n)} \\
 x_2^{(1)} &amp; x_2^{(2)} &amp; ... &amp; x_2^{(n)} \\
 \vdots    &amp; \vdots    &amp; \ddots &amp; \vdots \\
 x_m^{(1)} &amp; x_m^{(2)} &amp; ... &amp; x_m^{(n)} \\
\end{bmatrix}\,,\end{split}\]</div>
<p>where <span class="math notranslate nohighlight">\(n\)</span> is the number of samples.</p>
<p>Then, we define a linear operator <span class="math notranslate nohighlight">\(L\)</span> that, when applied to
uncorrelated standard samples <span class="math notranslate nohighlight">\(X\)</span>, converts them into
<span class="math notranslate nohighlight">\(N(0,\Sigma)\)</span>-distributed samples <span class="math notranslate nohighlight">\(K\)</span>.</p>
<div class="math notranslate nohighlight">
\[K = L X
\label{eq:corr_eq}\]</div>
<p>The operator <span class="math notranslate nohighlight">\(L\)</span> does not affect the mean of the distribution, since</p>
<div class="math notranslate nohighlight" id="equation-preserve-mean">
<span class="eqno">(2)<a class="headerlink" href="#equation-preserve-mean" title="Permalink to this equation">¶</a></span>\[E \left[ K \right] = E \left[ L X \right] = L E \left[ X \right] = 0 \,.\]</div>
<p>Also, the linearity of the operator preserves the shape of the distribution.</p>
<p>Then, the covariance becomes</p>
<div class="math notranslate nohighlight" id="equation-preserve-cov">
<span class="eqno">(3)<a class="headerlink" href="#equation-preserve-cov" title="Permalink to this equation">¶</a></span>\[E \left[ K K^T \right] =
E \left[ \left( L X \right) \left( L X \right)^T \right] =
L E \left[ X X^T \right] L^T =
L L^T \,,\]</div>
<p>since by definition <span class="math notranslate nohighlight">\(E \left[ X X ^T \right]\)</span> is the identity matrix.</p>
<p>The problem of sampling Normally distributed variables with covariance matrix
<span class="math notranslate nohighlight">\(\Sigma\)</span> reduces to finding <span class="math notranslate nohighlight">\(L\)</span> such that</p>
<div class="math notranslate nohighlight" id="equation-chol-condition">
<span class="eqno">(4)<a class="headerlink" href="#equation-chol-condition" title="Permalink to this equation">¶</a></span>\[L L^T = \Sigma \,.\]</div>
<p>SANDY calculates <span class="math notranslate nohighlight">\(L\)</span> by performing an eigendecomposition of
<span class="math notranslate nohighlight">\(\Sigma\)</span>.</p>
<p>Eventually, <span class="math notranslate nohighlight">\(K\)</span> can be converted into a <span class="math notranslate nohighlight">\(N(1,\Sigma)\)</span>-distributed
matrix of perturbation coefficients <span class="math notranslate nohighlight">\(P\)</span> by shifting the distribution mean
to the unit vector <span class="math notranslate nohighlight">\(1\)</span></p>
<div class="math notranslate nohighlight" id="equation-p-samples">
<span class="eqno">(5)<a class="headerlink" href="#equation-p-samples" title="Permalink to this equation">¶</a></span>\[\begin{split}P =
\begin{bmatrix}
p_1^{(1)} &amp; p_1^{(2)} &amp; ... &amp; p_1^{(n)} \\
p_2^{(1)} &amp; p_2^{(2)} &amp; ... &amp; p_2^{(n)} \\
\vdots    &amp; \vdots    &amp; \ddots &amp; \vdots \\
p_m^{(1)} &amp; p_m^{(2)} &amp; ... &amp; p_m^{(n)} \\
\end{bmatrix} =
K + 1 \,.\end{split}\]</div>
<div class="section" id="negative-eigenvalues">
<h3>Negative eigenvalues<a class="headerlink" href="#negative-eigenvalues" title="Permalink to this headline">¶</a></h3>
<p>By definition, covariance matrices are positive-definite, that is, their
eigenvalues are all positive.
These requirements must also be satisfied to apply the decomposition in Eq.
However, it is not rare to find covariance matrices for which it is not the case.</p>
<p>SANDY cannot investigate into the covariance evaluation process to
identify the sources of this issue.
Therefore, it reconstructs an approximate covariance matrix
<span class="math notranslate nohighlight">\(\widetilde{\Sigma}\)</span> with all negative eigenvalues set to zero.
This assumption is acceptable for small negative eigenvalues that are likely
to sprout from round-off or truncation processes.
For such cases it follows that <span class="math notranslate nohighlight">\(\widetilde{\Sigma} \approx \Sigma\)</span>.</p>
<p>To check whether the covariance eigenvalues are well represented by the
perturbations, option <code class="docutils literal notranslate"><span class="pre">--eig</span></code> was implemented in SANDY.</p>
<div class="admonition hint">
<p class="first admonition-title">Hint</p>
<p>to compare the first 20 eigenvalues, type</p>
<div class="code bash highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sandy</span>  <span class="o">&lt;</span><span class="n">endf6_file</span><span class="o">&gt;</span>  <span class="o">--</span><span class="n">samples</span> <span class="mi">100</span>  <span class="o">--</span><span class="n">eig</span> <span class="mi">20</span>
</pre></div>
</div>
<p class="last">By default, SANDY displays the first 10 eigenvalues.</p>
</div>
</div>
<div class="section" id="how-to-apply-multigroup-perturbations-to-continuous-energy-data">
<h3>How to apply multigroup perturbations to continuous-energy data<a class="headerlink" href="#how-to-apply-multigroup-perturbations-to-continuous-energy-data" title="Permalink to this headline">¶</a></h3>
<p>SANDY perturbation coefficients <span class="math notranslate nohighlight">\(P\)</span> reflect the multigroup energy structure
of the covariance matrix used for sampling.
On the contrary, the tabulated data in the ENDF-6 files are not defined for a energy
group structure, but they rather apply to a continuous-energy domain using a number of
explicitely given energy-value pairs <span class="math notranslate nohighlight">\((e_k,v_k)\)</span> and interpolation laws.</p>
<p>For any given coefficient <span class="math notranslate nohighlight">\(p_i^{(j)}\)</span> defined over an energy group
<span class="math notranslate nohighlight">\([e_i,e_{i+1}]\)</span>, SANDY perturbs all energy-value pairs
<span class="math notranslate nohighlight">\((e_k,v_k)\)</span> for which <span class="math notranslate nohighlight">\(e_i \leq e_k \leq e_{i+1}]\)</span> using the
following formula</p>
<div class="math notranslate nohighlight">
\[v_k^{(j)} = v_k p_i^{(j)} \,.\]</div>
<p>That is, if a cross section must be perturbed by 10% between 1 and 10 eV,
then all the values of the energy-value pairs in the corresponding <code class="docutils literal notranslate"><span class="pre">MF3</span></code>
section are multiplied by <span class="math notranslate nohighlight">\(0.1\)</span>.</p>
<div class="admonition important">
<p class="first admonition-title">Important</p>
<p class="last">This procedure implies that all cross section points in the energy interval
of interest are 100% correlated.</p>
</div>
<p>To make sure that the actual covariance structure is represented in the
perturbed files, SANDY adds additional energy-value pairs to the tabulated data.
This is particularly important when the covariance energy structure is finer
than the energy-value pair density, as it is often found in <code class="docutils literal notranslate"><span class="pre">MF4</span></code> and <code class="docutils literal notranslate"><span class="pre">MF5</span></code>
for energies below 1 KeV.</p>
</div>
<div class="section" id="how-to-handle-negative-samples">
<h3>How to handle negative samples<a class="headerlink" href="#how-to-handle-negative-samples" title="Permalink to this headline">¶</a></h3>
<p>When sampling from a Normal distribution, and in particular when the standard
deviations are large, it is likely to draw perturbation <span class="math notranslate nohighlight">\(&lt;=0\)</span> that, when
applied to the evaluated data they will make them change sign.
Physically, many quantities such as cross sections or energy ditributions are
intrinsically positive.
As a consequence, SANDY proposes two methods to handle negative perurbations:</p>
<ul class="simple">
<li><dl class="first docutils">
<dt>method 1:</dt>
<dd>perturbation coefficients outside the range <span class="math notranslate nohighlight">\([0,2]\)</span> are set to 1;</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>method 2:</dt>
<dd>perturbation coefficients outside the range <span class="math notranslate nohighlight">\([0,2]\)</span> are set either to 0 or 2 if they fall respectively below or above the defined range.</dd>
</dl>
</li>
</ul>
<p>A comparison of the two methods to represent different level of uncertainty is
reported in figure.</p>
<p>Given the strong nuclear data uncertainty reduction using the 1st method
for standard deviations larger than 40%, it was decided to implement the 2nd
method in the code.</p>
</div>
</div>
<div class="section" id="how-to-perturb-cross-sections">
<h2>How to perturb cross sections<a class="headerlink" href="#how-to-perturb-cross-sections" title="Permalink to this headline">¶</a></h2>
<p>To correctly perturb cross sections, SANDY needs the tabulated data in <code class="docutils literal notranslate"><span class="pre">MF3</span></code> to
be reconstructed from the resonance parameters in <code class="docutils literal notranslate"><span class="pre">MF2</span></code> and to be linearized,
so that for any energy point a cross section value can be retrieved via
linear interpolation.
ENDF-6 files that satisfy these conditions are called PENDF, or pointwise-ENDF,
files and are recognizible by a special flag in section <code class="docutils literal notranslate"><span class="pre">MF1/MT451</span></code>.
To produce such files it is common to utilize processing codes such as
<a class="reference external" href="http://www.njoy21.io/NJOY2016/">NJOY</a> (module RECONR) or <a class="reference external" href="https://www-nds.iaea.org/public/endf/prepro/">PREPRO</a> (modules RECENT and LINEAR).
Notice that SANDY does not perturb cross sections for files that are not in
PENDF format.</p>
<div class="section" id="covariances-for-resonance-parameters">
<h3>Covariances for resonance parameters<a class="headerlink" href="#covariances-for-resonance-parameters" title="Permalink to this headline">¶</a></h3>
<p>To perturb cross sections, one can choose to extract perturbations from
the <code class="docutils literal notranslate"><span class="pre">MF33</span></code> section in the original ENDF-6 file.</p>
<div class="code bash highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sandy</span>  <span class="o">&lt;</span><span class="n">pendf_file</span><span class="o">&gt;</span>  <span class="o">--</span><span class="n">cov</span> <span class="o">&lt;</span><span class="n">endf6_file</span><span class="o">&gt;</span>  <span class="o">--</span><span class="n">samples</span> <span class="mi">100</span>  <span class="o">--</span><span class="n">mf</span> <span class="mi">33</span>
</pre></div>
</div>
<p>By doing so, the user must be aware that the covariance information for the
resonance region will not be included, if the dedicated section <code class="docutils literal notranslate"><span class="pre">MF32</span></code> is
provided.</p>
<p>If that is the case, another choice to properly include both <code class="docutils literal notranslate"><span class="pre">MF32</span></code> and
<code class="docutils literal notranslate"><span class="pre">MF33</span></code> contributions is to:</p>
<blockquote>
<div><ol class="arabic simple">
<li>process the ENDF-6 file with the NJOY module ERRORR for a given
multigroup structure;</li>
<li>extract perturbations from the processed covariance matrix written
in the ERRORR output file.</li>
</ol>
</div></blockquote>
<div class="code bash highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sandy</span>  <span class="o">&lt;</span><span class="n">pendf_file</span><span class="o">&gt;</span>  <span class="o">--</span><span class="n">cov</span> <span class="o">&lt;</span><span class="n">errorr_file</span><span class="o">&gt;</span>  <span class="o">--</span><span class="n">samples</span> <span class="mi">100</span>  <span class="o">--</span><span class="n">mf</span> <span class="mi">33</span>
</pre></div>
</div>
<p>The ERRORR output contains a derived <code class="docutils literal notranslate"><span class="pre">MF33</span></code> sections that includes
both the cross sections and resonance parameters covariances.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">This is the preferred methodology used by the authors to produce perturbed files
with SANDY.</p>
</div>
<p>A template NJOY input file to produce a ERRORR output file is reported
below.</p>
</div>
<div class="section" id="redundant-cross-sections">
<h3>Redundant cross sections<a class="headerlink" href="#redundant-cross-sections" title="Permalink to this headline">¶</a></h3>
<p>The information stored in the various <code class="docutils literal notranslate"><span class="pre">MT</span></code> sections is often redundant <a class="footnote-reference" href="#id2" id="id1">[1]</a>,
in the sense that some cross sections can be derived from others via summation rules.
For example, the total cross section can be reconstructed as the sum of all the
partial (non-redundant) cross sections, or the total inelastic cross section can
be reconstructed as the sum of all the discrete and continuous inelastic levels.</p>
<table class="docutils footnote" frame="void" id="id2" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id1">[1]</a></td><td>A cross section is defined as redundant when it can be completely calculated
from the combination of other cross sections, according to the conservation
laws.</td></tr>
</tbody>
</table>
<p>SANDY automatically reconstruct redundant cross sections for each perturbed file.</p>
<p>Also, in the case pertrubations exist only for a redundant cross section, say
<code class="docutils literal notranslate"><span class="pre">MT4</span></code>, and not for its components, say from <code class="docutils literal notranslate"><span class="pre">MT51</span></code> to <code class="docutils literal notranslate"><span class="pre">MT91</span></code>.
Then, SANDY applies the <code class="docutils literal notranslate"><span class="pre">MT4</span></code> perturbations also to <code class="docutils literal notranslate"><span class="pre">MT51</span></code>, <code class="docutils literal notranslate"><span class="pre">MT52</span></code>, and so
on, to make sure that the perturbation is taken into account and that the sum of
the components equals the redundant cross section.</p>
<div class="admonition important">
<p class="first admonition-title">Important</p>
<p class="last">by imposing conservation laws such as summation rules, extra
levels of correlations are forced upon the random samples,
which might not be present in the original covariances.</p>
</div>
</div>
</div>
<div class="section" id="how-to-perturb-fission-neutron-multiplicities">
<h2>How to perturb fission neutron multiplicities<a class="headerlink" href="#how-to-perturb-fission-neutron-multiplicities" title="Permalink to this headline">¶</a></h2>
<p>Covariances for average fission neutron multiplicities are given in <code class="docutils literal notranslate"><span class="pre">MF31</span></code> for:</p>
<blockquote>
<div><ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">MT452</span></code> total fission neutrons;</li>
<li><code class="docutils literal notranslate"><span class="pre">MT455</span></code> delayed fission neutrons;</li>
<li><code class="docutils literal notranslate"><span class="pre">MT456</span></code> prompt fission neutrons.</li>
</ul>
</div></blockquote>
<p>To produce perturbed files where only the fission neutron mulitplicities are
varied, type</p>
<div class="code bash highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sandy</span>  <span class="o">&lt;</span><span class="n">endf6_file</span><span class="o">&gt;</span>  <span class="o">--</span><span class="n">samples</span> <span class="mi">100</span>  <span class="o">--</span><span class="n">mf</span> <span class="mi">31</span>
</pre></div>
</div>
<p>As for cross sections, the redundant total fission nubar is reconstructed from
the prompt and delayed fission nubar.</p>
</div>
<div class="section" id="how-to-perturb-angular-distributions">
<h2>How to perturb angular distributions<a class="headerlink" href="#how-to-perturb-angular-distributions" title="Permalink to this headline">¶</a></h2>
<p>The ENDF-6 formats allows angular distributions to be stored in section
<code class="docutils literal notranslate"><span class="pre">MF4</span></code> in two forms:</p>
<blockquote>
<div><ul class="simple">
<li>by tabulating the normalized probability distribution as a function of incident energy;</li>
<li>by tabulating the Legendre polynomial expansion coefficientsas a function of incident neutron energy.</li>
</ul>
</div></blockquote>
<p>However, the corresponing covariances in <code class="docutils literal notranslate"><span class="pre">MF34</span></code> only accept the second form.</p>
<p>To run SANDY to perturb only the angular distributions, type</p>
<div class="code bash highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sandy</span>  <span class="o">&lt;</span><span class="n">endf6_file</span><span class="o">&gt;</span>  <span class="o">--</span><span class="n">samples</span> <span class="mi">100</span>  <span class="o">--</span><span class="n">mf</span> <span class="mi">34</span>
</pre></div>
</div>
<p>If no option is specified, SANDY will perturb all Legendre polynomial
coefficients up to any order <a class="footnote-reference" href="#id4" id="id3">[2]</a>, as long as covariance data are available.
However, to consider only covariances for Legendre polynomial coefficients
up to a given order, say 2, one must type</p>
<table class="docutils footnote" frame="void" id="id4" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id3">[2]</a></td><td>all correlations between different Legendre polynomial coefficients are
also taken into account.</td></tr>
</tbody>
</table>
<div class="code bash highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sandy</span>  <span class="o">&lt;</span><span class="n">endf6_file</span><span class="o">&gt;</span>  <span class="o">--</span><span class="n">samples</span> <span class="mi">100</span>  <span class="o">--</span><span class="n">mf</span> <span class="mi">34</span>  <span class="o">--</span><span class="nb">max</span><span class="o">-</span><span class="n">polynomial</span> <span class="mi">2</span>
</pre></div>
</div>
</div>
<div class="section" id="how-to-perturb-energy-distributions">
<h2>How to perturb energy distributions<a class="headerlink" href="#how-to-perturb-energy-distributions" title="Permalink to this headline">¶</a></h2>
<p>Covariances for outgoing energy distributions in <code class="docutils literal notranslate"><span class="pre">MF35</span></code> are mostly given for
prompt fission neutron spectra (PFNS) and for few incident energy ranges,
therefore assuming large correlations for distributions associated to incident
energies in the same range.
In addition, the format does not allow correlations between spectra that do not
belong to the same range.</p>
<p>To perturb only energy distributions, type</p>
<div class="code bash highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sandy</span>  <span class="o">&lt;</span><span class="n">endf6_file</span><span class="o">&gt;</span>  <span class="o">--</span><span class="n">samples</span> <span class="mi">100</span>  <span class="o">--</span><span class="n">mf</span> <span class="mi">35</span>
</pre></div>
</div>
<p>SANDY draws samples from each covariance matrix independently.
Then, the perturbations are applied to each evaluated energy distribution only
if the incident neutron energy belongs to the covariance range.</p>
<div class="section" id="normalization">
<h3>Normalization<a class="headerlink" href="#normalization" title="Permalink to this headline">¶</a></h3>
<p>Being probability distributions, all perturbed PFNS must be normalized to unity.
If the normalization was already included in the covariance matrix, the sums of
the elements in any row (and in any column) would be equal to zero <a class="footnote-reference" href="#id6" id="id5">[3]</a>.</p>
<p>To make up for covariances that do not comply with this rule, SANDY normalizes
all perturbed energy distributions.</p>
<table class="docutils footnote" frame="void" id="id6" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id5">[3]</a></td><td>This constraint is also called the <em>zero-sum</em> rule.</td></tr>
</tbody>
</table>
<div class="admonition important">
<p class="first admonition-title">Important</p>
<p class="last">by imposing conservation laws such as data normalization, extra
levels of correlations are forced upon the random samples,
which might not be present in the original covariances.</p>
</div>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="uncertainty_propagation.html" class="btn btn-neutral float-right" title="Uncertainty propagation" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="endf6.html" class="btn btn-neutral" title="The ENDF-6 format" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2018, Luca Fiorito

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script type="text/javascript" src="_static/jquery.js"></script>
        <script type="text/javascript" src="_static/underscore.js"></script>
        <script type="text/javascript" src="_static/doctools.js"></script>
        <script async="async" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    

  

  <script type="text/javascript" src="_static/js/theme.js"></script>

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>